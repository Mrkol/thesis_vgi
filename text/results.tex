
\section{Результаты}
Имплементация описанного выше решения была написана на C++20 с использованием библиотек Eigen, Function2, GLFW3, Cxxopts и Vulkan. Исходный код имеет размер порядка 10000 строк и доступен по ссылке \url{https://github.com/Mrkol/thesis_vgi}.

В качестве тестовых моделей были выбраны 3D-сканы Quixel Megascans \cite{quixel_megascans} в максимальном качестве. В следующей таблице приведено время работы этапов предобработки, а также количество полигонов и название использованных моделей. В столбец "подготовка" объединены этапы (1-2), в столбец "кластеризация" этапы (3-4), в "квадрангуляцию" -- (5-6), а последние 2 столбца соответствуют этапам (7) и (8). В разных строках указаны запуски с разной целевой ошибкой кластеризации, в столбце "кластеры" указано итоговое количество кластеров. Замеры происходили на Intel Core i5-470 (3.20Ghz) и видеокарте NVIDIA GeForce RTX 2070 SUPER.


\begin{table}[ht]
\small
\centering
\begin{tabular}{ l | p{16mm} | p{15mm} | p{17mm} | p{12mm} | p{14mm} | p{13mm} | p{17mm} }
                        & Полигоны (млн.) & Кластеры & Подготовка (мин.) & Кластер. (мин.) & Квадранг. (мин.) & Репарам. (мин.) & Ресемплинг (мин.) \\
\hline
\multirow{2}{18mm}{Rock Cliffs (uchwaffda)}
& 3    & 130 & 2.1   & 0.8  & 40   & 105    & 0.2   \\
& 3    & 164 & 2.1   & 0.8  & 40   & 83     & 0.2   \\
\hline
\multirow{3}{16mm}{Rock Sandstone (rlbx3)}
& 5    & 30  & 3.4   & 1.4  & 116  & 700    & 0.5   \\
& 5    & 224 & 3.5   & 1.4  & 34   & 200    & 0.3   \\
&&&&&&&\\
\end{tabular}
\caption{Производительность алгоритма предобработки}
\end{table}

Как видно из таблицы, время затраченное на репараметризацию сильно зависит от количества кластеров. Более того, при малом числе кластеров их форма как правило становится достаточно иррегулярной, что приводит к значительно большему времени на этапе квадрангуляции из-за необходимости делить рёбра. С другой стороны большее число кластеров приводит к более медленному рендерингу из-за необходимости адаптировать б\'ольшее число квадродеревьев.

\begin{figure}[h]
  \minipage{0.45\textwidth}
    \begin{tikzpicture}
      \begin{axis}[
          scale=0.85,
          ybar,
          symbolic x coords={Минимум,Среднее,Максимум},
          xtick=data,
          enlarge x limits=0.2,
          legend style={at={(0.025,0.975)}, anchor=north west},
          ylabel={FPS}
          ]
        \addplot[ybar,fill=yellow] coordinates {
          (Минимум,250) (Среднее,290) (Максимум,420)
        };
        \addplot[ybar,fill=red] coordinates {
          (Минимум,200) (Среднее,260) (Максимум,682)
        };
        \addplot[ybar,fill=blue] coordinates {
          (Минимум,24) (Среднее,26) (Максимум,457)
        };
        \legend{Уровни детализации,Предлагаемый метод,Исходная модель}
      \end{axis}
    \end{tikzpicture}
    \caption{Производительность рендеринга модели ``Rock Cliffs (uchwaffda)'' в кадрах в секунду (FPS, frames per second). Больше -- лучше}
    \label{fig:uchwaffda_perf}
  \endminipage\hfill
%
  \minipage{0.45\textwidth}
    \begin{tikzpicture}
      \begin{axis}[
          scale=0.85,
          ybar,
          symbolic x coords={Минимум,Среднее,Максимум},
          xtick=data,
          enlarge x limits=0.2,
          legend style={at={(0.025,0.975)}, anchor=north west},
          ylabel={FPS}
          ]
        \addplot[ybar,fill=yellow] coordinates {
          (Минимум,130) (Среднее,140) (Максимум,250)
        };
        \addplot[ybar,fill=red] coordinates {
          (Минимум,103) (Среднее,140) (Максимум,309)
        };
        \addplot[ybar,fill=blue] coordinates {
          (Минимум,21) (Среднее,23) (Максимум,403)
        };
        \legend{Уровни детализации,Предлагаемый метод,Исходная модель}
      \end{axis}
    \end{tikzpicture}
    \caption{Производительность рендеринга модели ``Rock Assembly Rough (sjzbj)'' в кадрах в секунду (FPS, frames per second). Больше -- лучше}
    \label{fig:sjzbj_perf}
  \endminipage\hfill
\end{figure}

Производительность и качество рендерига же измерялись на процессоре Intel Core i7-8550U и его встроенной видеокарте. Производительность алгоритма при движении камеры показана на рисунках \ref{fig:uchwaffda_perf}-\ref{fig:sjzbj_perf}. Для сравнения были взяты исходная высокополигональная модель отрендеренная и предоставляемые Quixel её уровни детализации. Из графиков видно, что использование иерархического атласа не сильно ухудшает производительность по сравнению с наивным использованием уровней детализации, но при этом в разы быстрее рендеринга полной исходной модели.

Противопоставим эти показатели итоговому качеству картинки. Для его измерения была использована метрика SSIM \cite{wang2004image}, разработанная специально для сравнения видимого качества семантически одинаковых изображений. Сравниваемые изображения, а также изображения каркасов соответствующих моделей, представлены на рисунках \ref{fig:preview1start}-\ref{fig:preview3end}. Изображения полученные при помощи разработанного решения, а также полученные с помощью наивных уровней детализации, были сопоставлены с исходной высокополигональной моделью с трёх разных ракурсов. Результаты представлены на рисунке \ref{fig:quality}. Таким образом разработанное решение позволяет добиться качества на 20 процентных пунктов лучше наивного подхода, при этом незначительно проигрывая ему в производительности.

\newcommand{\showpreviews}[1]{
  \begin{figure}[h]
    \minipage{0.32\textwidth}
      \centering
      \includegraphics[scale=0.079]{high#1}
      \caption{Оригинальная модель. Вид с ракурса #1}
      \label{fig:preview#1start}
    \endminipage\hfill
    \minipage{0.32\textwidth}
      \centering
      \includegraphics[scale=0.079]{ours#1}
      \caption{Предлагаемый метод. Вид с ракурса #1}
    \endminipage\hfill
    \minipage{0.32\textwidth}
      \centering
      \includegraphics[scale=0.079]{lod#1}
      \caption{Уровни детализации. Вид с ракурса #1}
    \endminipage
    \\
    \minipage{0.32\textwidth}
      \centering
      \includegraphics[scale=0.079]{high#1_wireframe}
      \caption{Оригинальная модель. Вид с ракурса #1 (сетка)}
    \endminipage\hfill
    \minipage{0.32\textwidth}
      \centering
      \includegraphics[scale=0.079]{ours#1_wireframe}
      \caption{Предлагаемый метод. Вид с ракурса #1 (сетка)}
    \endminipage\hfill
    \minipage{0.32\textwidth}
      \centering
      \includegraphics[scale=0.079]{lod#1_wireframe}
      \caption{Уровни детализации. Вид с ракурса #1 (сетка)}
      \label{fig:preview#1end}
    \endminipage
  \end{figure}
}

\showpreviews{1}
\showpreviews{2}
\showpreviews{3}

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
        width=0.8\textwidth,
        height=0.6\textwidth,
        ybar,
        ymin=0,ymax=1,
        symbolic x coords={Разработанное решение,Уровни детализации},
        xtick=data,
        enlarge x limits=0.2,
        ylabel={SSIM},
        ]
      \addplot[ybar,fill=yellow] coordinates {
        (Разработанное решение,0.845) (Уровни детализации,0.627)
      };
      \addplot[ybar,fill=red] coordinates {
        (Разработанное решение,0.844) (Уровни детализации,0.740)
      };
      \addplot[ybar,fill=blue] coordinates {
        (Разработанное решение,0.834) (Уровни детализации, 0.640)
      };
    \end{axis}
  \end{tikzpicture}
  \caption{SSIM-качество отрендереных изображений с трёх ракурсов (обозначены цветами). Больше -- лучше}
  \label{fig:quality}
\end{figure}
